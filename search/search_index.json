{"config":{"lang":["es"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Introducci\u00f3n","text":"<p>En esta web vamos a encontrar diversos contenidos que resultar\u00e1n \u00fatiles para una o varias de las gu\u00edas para iniciarnos en placas como Keyestudio UNO, micro:bit, ESP32 micro:STEAMakers, ESP32STEAMakers, sensor de visi\u00f3n artificial Sentry2 y otras.</p>"},{"location":"CO2/","title":"Conceptos sobre CO2 y VOC","text":"<p>En general vamos a dar unas pautas de lo que son, por que son perjudiciales para la salud, que valores podemos tomar como referencia para determinar la calidad del aire y sus fuentes principales de emisi\u00f3n en entornos de trabajo no industriales (oficinas, locutorios, etc) y aulas escolares. Veremos al final el sensor que vamos a usar y algunas cosas interesantes sobre el mismo.</p>"},{"location":"CO2/#sobre-el-co2","title":"Sobre el CO2","text":"<p>El di\u00f3xido de carbono es un gas inodoro e incoloro. Bajo presi\u00f3n puede encontrarse en estado l\u00edquido o estado s\u00f3lido (hielo seco).</p> <p>En el enlace podemos encontrar mas definiciones de t\u00e9rminos usuales dadas por el Departamento de Salud de New Jersey.</p>"},{"location":"CO2/#necesidad-de-vigilar-los-niveles-de-co2","title":"Necesidad de vigilar los niveles de CO2","text":"<p>De manera muy resumida diremos que al respirar aire con mucho CO2, aumenta su concentraci\u00f3n en sangre, baja el pH de la misma, y esto dispara la sensaci\u00f3n de asfixia.</p> <p>En la p\u00e1gina 8 de la Ficha T\u00e9cnica de Seguridad n\u00famero 300000000020 se indican claramente los efecto perjudiciales del CO2 que relacionamos a continuaci\u00f3n.</p> <p>Efectos debido a la inhalaci\u00f3n:</p> <ul> <li>Una concentraci\u00f3n de CO2 superior o igual al 10% puede causar p\u00e9rdida de consciencia o muerte.</li> <li>El bi\u00f3xido de carbono tiene la capacidad de provocar la muerte, incluso si se mantienen los niveles normales de ox\u00edgeno (20 a 21%).</li> <li>El bi\u00f3xido de carbono es fisiol\u00f3gicamente activo, afecta la circulaci\u00f3n y la respiraci\u00f3n.</li> <li>A concentraciones de 2 a 10%, el bi\u00f3xido de carbono puede ocasionar n\u00e1usea, mareo, dolor de cabeza, confusi\u00f3n, aumento de la presi\u00f3n arterial y la frecuencia respiratoria.</li> <li>A elevadas concentraciones puede causar asfixia.</li> <li>Los s\u00edntomas pueden incluir la p\u00e9rdida de la consciencia o de la movilidad.</li> <li>La v\u00edctima puede no haberse dado cuenta de la asfixia. La asfixia puede causar la inconsciencia tan inadvertida y r\u00e1pidamente que la v\u00edctima puede ser incapaz de protegerse.</li> </ul> <p>S\u00edntomas:</p> <ul> <li>V\u00e9rtigo.</li> <li>Salivaci\u00f3n.</li> <li>N\u00e1usea.</li> <li>V\u00f3mitos.</li> <li>P\u00e9rdida de movilidad/consciencia.</li> <li>Escalofr\u00edos.</li> <li>Sudor.</li> <li>Visi\u00f3n borrosa.</li> <li>Dolor de cabeza.</li> <li>Aumento de pulsaciones.</li> <li>Insuficiencia respiratoria.</li> <li>Respiraci\u00f3n r\u00e1pida.</li> </ul> <p>Toxicidad aguda por inhalaci\u00f3n:</p> <ul> <li>Un nivel de CO2 del 5% act\u00faa de manera sin\u00e9rgica e incrementa la toxicidad de otros gases (CO, NO2).</li> <li>El CO2 incrementa la producci\u00f3n de carboxihemoglobina o metahemoglobina ocasionada por estos gases, probablemente debido a los efectos estimulantes del bi\u00f3xido de carbono en los sistemas respiratorio y circulatorio.</li> </ul> <p>Podemos consultar mas datos sobre el CO2 en la Ficha de seguridad oficial.</p> <p>En la entrada Di\u00f3xido de carbono del Instituto para la Salud Geoambiental podemos leer:</p> <p>Efectos en la salud:</p> <p>El principal efecto que produce el CO2 es la asfixia por desplazamiento del ox\u00edgeno, pero esto se produce por concentraciones muy altas capaces de desplazar el ox\u00edgeno y reducir su concentraci\u00f3n por debajo del 20%. En concentraciones altas, cercanas a la 30.000 ppm, puede causar dolores de cabeza, falta de concentraci\u00f3n, somnolencia, mareos y problemas respiratorios. En entornos laborales, como oficinas, se comienzan a tener quejas de olores a partir de las 800-1000 ppm.</p> <p>Colegios y CO2</p> <p>Es importante se\u00f1alar que las personas con problemas de asma o SQM deben proveerse de un aire con bajas concentraciones de CO2.</p> <p>Vamos a considerar solamente, y a efectos de estas notas, la \u00faltima reglamentaci\u00f3n RITE sin referirnos al RITE o NTE anteriores. C\u00f3mo se indica mas abajo el RITE, o Reglamento de Instalaciones T\u00e9rmicas en los Edificios y sus IT (Instrucciones T\u00e9cnicas) contempla que el nivel de CO2 aconsejable en el interior de edificios, seg\u00fan los estudios y normas de referencia, se recomienda que se mantenga en niveles entre las 400 ppm y las 800 ppm. Teniendo en cuenta que el RITE se publica en su primera versi\u00f3n por el Real Decreto 1027/2007, de 20 de julio, por el que se aprueba el Reglamento de Instalaciones T\u00e9rmicas en los Edificios (BOE 29/08/2007) y que tiene varias correcciones de errores y modificado de art\u00edculos hasta su Versi\u00f3n consolidada del Real Decreto 1027/2007, de 20 de julio por el que se aprueba el Reglamento de instalaciones t\u00e9rmicas en los edificios es muy posible que la mayor\u00eda de los centros educativos de construcci\u00f3n anterior a estas fechas no tengan adecuadas sus instalaciones para cumplir esta reglamentaci\u00f3n, cosa que por otra parte ser\u00eda muy deseable y que de seguro se habr\u00eda logrado con una normativa espec\u00edfica para estos locales.</p> <p>Un grupo a tener en cuenta especialmente son los ni\u00f1os en los colegios. En Espa\u00f1a no hay normativa espec\u00edfica que regule el nivel de CO2 en los colegios, como si lo tienen por ejemplo en Francia, y es bien conocida la relaci\u00f3n entre el bajo rendimiento escolar y los altos niveles de CO2. Adem\u00e1s los ni\u00f1os debido a su metabolismo y actividad producen mucho m\u00e1s CO2 que los adultos.</p> <p>A ra\u00edz de la pandemia, que a d\u00eda de hoy (mayo de 2021) nos sigue acompa\u00f1ando se han publicado multitud de gu\u00edas y recomendaciones para indicar la necesidad de ventilaci\u00f3n en las aulas, que con las medidas anti-covid establecidas en los centros y el gran compromiso adquirido por todo el personal relacionado con la vida de los centros y el propio alumnado, hemos de decir que los centros educativos han sido capaces de mantener un nivel de contagios que ha permitido mantenerlos en funcionamiento. A t\u00edtulo de ejemplo tenemos la Gu\u00eda para ventilaci\u00f3n en aulas del Instituto de Diagn\u00f3stico Ambiental y Estudios del Agua, IDAEA-CSIC, Mesura en su VERSI\u00d3N 3 de 6 de noviembre de 2020.</p> <p>Principales Fuentes:</p> <p>La principal fuente en ambientes interiores es la respiraci\u00f3n humana. Se deben considerar otras posibles fuentes debidas a combusti\u00f3n en casos de altos niveles de concentraci\u00f3n.</p> <p>Niveles habituales:</p> <p>Los niveles habituales que podamos encontrar en un ambiente interior estar\u00e1 relacionado con las diferentes variables que afectan a este factor como son: Niveles en aire exterior, fuentes interiores, niveles de ocupaci\u00f3n y tasas de ventilaci\u00f3n.</p> <p>En la legislaci\u00f3n existente no hay un valor concreto que se d\u00e9 como bueno. Existen diferentes recomendaciones y valores l\u00edmite ocupacionales. En el RITE por ejemplo en funci\u00f3n del nivel de calidad de aire exigible al local los valores de concentraci\u00f3n van desde las 400 ppm hasta m\u00e1s de 1.000 ppm. El valor l\u00edmite de exposici\u00f3n profesional para exposiciones de 8 horas que vemos en las Gu\u00edas del INSHT es de 5.000 ppm si bien este valor no se puede aplicar a entornos no industriales. Recordemos que en espacios como oficinas a partir de 800 ppm se producen quejas por olores y se recomienda no superar las 1.000 ppm.</p> <p>Lo ideal es que el cociente entre exterior e interior sea lo m\u00e1s cercano a 1 posible.</p> <p>En el art\u00edculo de la International Journal of Emergency Medicine dado en la webgraf\u00eda se pueden consultar mas datos relativos al tema del CO2 y en el de Centro Canadiense de Seguridad y Salud Ocupacional (CCSSO) tenemos respuestas a diversas cuestiones sobre el CO2.</p>"},{"location":"CO2/#riesgos-de-transmision-de-covid-19-en-distintas-situaciones","title":"Riesgos de transmisi\u00f3n de covid-19 en distintas situaciones","text":"<p>En la figura 3 del art\u00edculo Editorial de BMJ dado en la webgraf\u00eda podemos leer que la gr\u00e1fica exponer el Riesgo de transmisi\u00f3n del SARS-CoV-2 de personas asintom\u00e1ticas en diferentes entornos y para diferentes tiempos de ocupaci\u00f3n, ventilaci\u00f3n y niveles de hacinamiento (ignorando la variaci\u00f3n en la susceptibilidad y las tasas de diseminaci\u00f3n viral). Las calificaciones son indicativas de riesgo relativo cualitativo y no representan una medida cuantitativa. Es posible que tambi\u00e9n deban tenerse en cuenta otros factores no presentados en estas tablas al considerar el riesgo de transmisi\u00f3n, incluida la carga viral de una persona infectada y la susceptibilidad de las personas a la infecci\u00f3n. Toser o estornudar, incluso si se deben a irritaci\u00f3n o alergias mientras est\u00e9 asintom\u00e1tico, agravar\u00eda el riesgo de exposici\u00f3n en un espacio interior, independientemente de la ventilaci\u00f3n.</p> <p>Reproducimos aqu\u00ed la gr\u00e1fica en formato original traducida para que nos sirva de gu\u00eda.</p> <p> Clic para ampliar </p>"},{"location":"CO2/#unidades-de-medida-del-co2","title":"Unidades de medida del CO2","text":"<p>Las formas m\u00e1s habituales de indicar la concentraci\u00f3n de un contaminante atmosf\u00e9rico son las ppb (partes por bill\u00f3n) y las ppm (partes por mill\u00f3n), los \u00b5g/m\u00b3 (microgramos por metro c\u00fabico) y los mg/m\u00b3 (miligramos por metro c\u00fabico).</p> <p>Las ppb y las ppm se suelen utilizar cuando se trata de un gas, y en este caso se sobreentiende que se expresa en volumen. Muchas veces se puede encontrar escrito como ppbv o ppmv, donde la \u201cv\u201d final indica precisamente que la concentraci\u00f3n es en volumen.</p> <p>De esta forma, 1 ppm es unidad de volumen de contaminante en un mill\u00f3n de unidades de volumen de aire. Para concentraciones altas de CO2 se usa el porcentaje volum\u00e9trico (unidades de volumen de CO2 en 100 unidades de volumen de aire), es decir que 10.000 ppm = 1%.</p> <p>Es importante tener en cuenta que el bill\u00f3n de estas ppb es un bill\u00f3n anglosaj\u00f3n, esto es, 1000 millones de vol\u00famenes (\\(10^9\\)). En Europa un bill\u00f3n es 1 mill\u00f3n de millones, \\(10^{12}\\), por lo que la equivalencia es: 1ppm = 1000ppb</p> <p>Otras dos formas habituales de expresar la concentraci\u00f3n de los contaminantes atmosf\u00e9ricos son los \u00b5g/m\u00b3 (microgramos por metro c\u00fabico) y los mg/m\u00b3 (miligramos por metro c\u00fabico). La equivalencia es similar a las de ppm y ppb:</p> <p>1 mg/m\u00b3 = 1000 \u00b5g/m\u00b3</p> <p>Para convertir las ppb en \u00b5g/m\u00b3 tenemos que tener en cuenta que dicha conversi\u00f3n depende del tipo de contaminante, y de una presi\u00f3n y una temperatura que tomemos como referencia. Para ver esto, tomemos una concentraci\u00f3n de 1 ppb de un contaminante M. Esto implica que tenemos 1 m\u00b3 de M en \\(10^9\\) m\u00b3 de aire. O lo que es lo mismo, \\(10^{\u22129}\\) m\u00b3 de M en 1 m\u00b3 de aire.</p> <p>La forma habitual de expresar la concentraci\u00f3n de CO2 es en mg/m\u00b3 (miligramos por metro c\u00fabico). Para convertir las ppm en mg/m\u00b3 tenemos que tener en cuenta que dicha conversi\u00f3n depende del tipo de gas, y de una presi\u00f3n y una temperatura que tomemos como referencia.</p> <p>Teniendo en cuenta la ecuaci\u00f3n general de los gases ideales, para el CO2 (con peso molecular 44,01 g/mol), y tomando como referencia P = 1 atm y T = 298,16 K (25 \u00baC), tenemos (R = 0,08205746 atm\u00b7L/mol\u00b7K):</p> <p> <p>\\(\\dfrac{10^{6}\\cdot 44,01\\hspace{0.1cm} g/mol\\cdot 1\\hspace{0.1cm}atm\\cdot 10^{-6}}{0,08205746\\cdot 298,16\\hspace{0.1cm}K}=1,798\\hspace{0.1cm}mg\\hspace{0.1cm}\\approx\\hspace{0.1cm}1,8\\hspace{0.1cm}mg\\)</p> <p></p> <p>Luego:</p> <p> <p>\\(\\boxed{1\\hspace{0.1cm}ppm=1,8\\hspace{0.1cm}mg/m^{3}\\hspace{1cm}(CO_{2}\\hspace{0.2cm}@\\hspace{0.2cm}1\\hspace{0.2cm}atm.\\hspace{0.2cm} 25\\hspace{0.2cm}\u00baC)}\\)</p> <p></p> <p>Que ser\u00e1 la relaci\u00f3n a usar para convertir entre unidades de CO2.</p> <p>Tambi\u00e9n se puede expresar como:</p> <p> <p>\\(\\boxed{1\\hspace{0.1cm}ppb=1800\\hspace{0.1cm}\\mu g/m^{3}\\hspace{1cm}(CO_{2}\\hspace{0.2cm}@\\hspace{0.2cm}1\\hspace{0.2cm}atm.\\hspace{0.2cm} 25\\hspace{0.2cm}\u00baC)}\\)</p> <p></p>"},{"location":"CO2/#valores-de-referencia-para-el-co2","title":"Valores de referencia para el CO2","text":"<p>En la tabla siguientes damos los valores que vamos a considerar en nuestro caso. En la columna color se establece cual ser\u00e1 el color que se ilumine en un posible sem\u00e1foro.</p> <p> CO2 (ppm) CO2 (\\(mg / m ^{3}\\)) Ambiente Mensaje Color de 0 a 500 de 0 a 900 Muy bueno Aconsejado Apagado de 501 a 1000 de 901 a 1800 Bueno Bueno Verde de 1001 a 1500 de 1801 a 2700 Moderado ventilar Amarillo de 1501 a 2000 de 2701 a 3600 Muy malo VENTILAR Rojo fijo mas de 2000 mas de 3600 Inaceptable Desalojar Rojo intermitente <p></p>"},{"location":"CO2/#fuentes-emisoras-de-co2-en-personas","title":"Fuentes emisoras de CO2 en personas","text":"<p>En el ambiente que nos ocupa la principal fuente de emisi\u00f3n de CO2 va a ser el ser humano a trav\u00e9s de la respiraci\u00f3n, la sudoraci\u00f3n, la transpiraci\u00f3n y el sudor.</p>"},{"location":"CO2/#sobre-los-voc","title":"Sobre los VOC","text":"<p>VOC (Volatile Organic Compounds) es la abreviatura inglesa para los compuestos org\u00e1nicos vol\u00e1tiles (COV) que hay en el aire en forma de gas o de vapor a temperatura ambiente. Los VOC tienen muy diversa procedencia pero nos interesa en este caso los generados en los procesos biol\u00f3gicos de las personas que los emiten a trav\u00e9s de la respiraci\u00f3n y de la piel.</p> <p>Los efectos sobre la salud a corto plazo pueden ser:</p> <ul> <li> <p>Irritaci\u00f3n de ojos, garganta y nariz</p> </li> <li> <p>N\u00e1useas</p> </li> <li> <p>Dolor de cabeza</p> </li> <li> <p>V\u00f3mito de sangre</p> </li> <li> <p>Reacciones al\u00e9rgicas e hinchazones</p> </li> <li> <p>Mareos</p> </li> <li> <p>Dolores estomacales e intestinales</p> </li> <li> <p>Fatiga</p> </li> <li> <p>Manchas en la piel.</p> </li> </ul> <p>A largo plazo pueden da\u00f1ar el h\u00edgado, los ri\u00f1ones o el sistema nervioso central. Tambi\u00e9n pueden ser carcin\u00f3genos, como por ejemplo el benceno.</p>"},{"location":"CO2/#valores-de-referencia-para-voc","title":"Valores de referencia para VOC","text":"<p>En la tabla siguiente damos los valores que vamos a considerar en nuestro caso.</p> <p> VOC (ppb) Ambiente Mensaje Color de 0 a 200 Muy bueno Aconsejado Apagado de 201 a 600 Bueno Bueno Verde de 601 a 1000 Moderado ventilar Amarillo de 1001 a 2000 Muy malo VENTILAR Rojo fijo mas de 2000 Inaceptable Desalojar Rojo intermitente <p></p>"},{"location":"CO2/#fuentes-emisoras-de-voc-en-personas","title":"Fuentes emisoras de VOC en personas","text":"<p>En el ser humano se producen diferentes gases VOC a trav\u00e9s de la respiraci\u00f3n (acetona, etanol, isopreno), la sudoraci\u00f3n, la transpiraci\u00f3n, el sudor, por flato (metano), los cosm\u00e9ticos (Limoneno, eucaliptol), el mobiliaario (alcoholes), la combusti\u00f3n de motores y calderas (hidrocarburos) y los ordenadores, impresoras o fotocopiadoras (benceno, estireno, fenol).</p>"},{"location":"CO2/#el-sensor-ccs811","title":"El sensor CCS811","text":"<p>Es un sensor de gas digital que puede detectar una amplia gama de compuestos org\u00e1nicos vol\u00e1tiles. En este caso se denominan TVOC, pues el sensor no distingue unos de otros y la medida la totaliza. Tambi\u00e9n detecta niveles equivalentes de di\u00f3xido de carbono que se denominan eCO2.</p> <p>Los rangos de medida son:</p> <ul> <li> <p>eCO2: de 400 a 29206 ppm (partes por millon).</p> </li> <li> <p>TVOC: de 0 a 32768 ppb (partes por bill\u00f3n).</p> </li> </ul>"},{"location":"basicoUDP/","title":"Conceptos b\u00e1sicos de UDP","text":"<p>(Fuente: Wikipedia)</p> <p>En redes inform\u00e1ticas, el Protocolo de Datagramas de Usuario (UDP) es uno de los protocolos de comunicaci\u00f3n centrales del conjunto de protocolos de Internet utilizado para enviar mensajes (transportados como datagramas en paquetes) a otros hosts en una red de Protocolo de Internet (IP). Dentro de una red IP, UDP no requiere comunicaci\u00f3n previa para establecer canales de comunicaci\u00f3n o rutas de datos.</p> <p>UDP utiliza un modelo sencillo de comunicaci\u00f3n sin conexi\u00f3n con un m\u00ednimo de mecanismos de protocolo. UDP proporciona n\u00fameros de puerto para direccionar diferentes funciones en el origen y el destino del datagrama. No tiene di\u00e1logos de toma de contacto y, por tanto, no hay garant\u00eda de entrega, orden o protecci\u00f3n contra duplicados.</p> <p>UDP es adecuado para fines en los que la comprobaci\u00f3n y correcci\u00f3n de errores no son necesarias o se realizan en la aplicaci\u00f3n. Las aplicaciones sensibles al tiempo suelen utilizar UDP porque es preferible soltar paquetes que esperar a que se retrasen debido a la retransmisi\u00f3n, que puede no ser una opci\u00f3n en un sistema en tiempo real.</p> <p>Las caracter\u00edsticas principales de este protocolo son:</p> <ol> <li>Trabaja sin conexi\u00f3n, es decir, que no emplea ninguna sincronizaci\u00f3n entre el origen y el destino.</li> <li>Trabaja con paquetes o datagramas enteros, no con bytes individuales como TCP. Una aplicaci\u00f3n que emplea el protocolo UDP intercambia informaci\u00f3n en forma de bloques de bytes, de forma que por cada bloque de bytes enviado de la capa de aplicaci\u00f3n a la capa de transporte, se env\u00eda un paquete UDP.</li> <li>No es fiable. No emplea control del flujo ni ordena los paquetes.</li> <li>Su gran ventaja es que provoca poca carga adicional en la red, ya que es sencillo y emplea cabeceras muy simples.</li> </ol>"},{"location":"basicoUDP/#los-puertos-udp","title":"Los puertos UDP","text":"<p>Las aplicaciones pueden utilizar sockets (conectores) de datagramas para establecer comunicaciones de host (equipo) a host (equipo). Una aplicaci\u00f3n vincula un socket a su punto final de transmisi\u00f3n de datos, que es una combinaci\u00f3n de una direcci\u00f3n IP y un puerto. De esta forma, UDP proporciona multiplexaci\u00f3n de aplicaciones. Un puerto es una estructura de software que se identifica por el n\u00famero de puerto, un valor entero de 16 bits, que permite n\u00fameros de puerto entre 0 y 65535.</p> <ul> <li>El puerto 0 est\u00e1 reservado, pero es un valor de puerto de origen admisible si el proceso de env\u00edo no espera mensajes como respuesta.</li> <li>Los puertos 1 a 1023 se llaman puertos \"bien conocidos (well-known)\" y en sistemas operativos tipo Unix enlazar con uno de estos puertos requiere acceso como superusuario.</li> <li>Los puertos 1024 a 49.151 son puertos registrados usados por IANA-registered services. IANA son las siglas de Internet Assigned Numbers Authority que es el Registro de nombres de servicio y n\u00fameros de puerto de protocolo de transporte.</li> <li>Los puertos 49.152 a 65.535 son puertos din\u00e1micos y son utilizados como puertos temporales, sobre todo por los clientes al comunicarse con los servidores.</li> </ul> <p>En Anexo:Puertos de red de Wikipedia hay un amplio listado de puertos y su descripci\u00f3n.</p>"},{"location":"basicoUDP/#udp-en-microblocks","title":"UDP en MicroBlocks","text":"<p>La implementaci\u00f3n de MicroBlocks del protocolo UDP se manifiesta en la libreria UDP. No hay ning\u00fan requisito especial antes de usar el protocolo, aparte de que los dispositivos implicados tienen que estar presentes en una red IP compartida, en nuestro caso nuestro WiFi local.</p> <p>Veamos una descripci\u00f3n de los bloques que componen esta libreria:</p> <ul> <li>inicia UDP en el puerto...</li> </ul> <p> <p> </p> <p></p> <p>Este bloque configura el script para que escuche los mensajes UDP en el puerto designado. La direcci\u00f3n IP propia del dispositivo y el n\u00famero de puerto especificado forman un socket e identifican de forma \u00fanica el dispositivo y cualquier servicio de software que proporcione. Seg\u00fan lo anterior:</p> <ul> <li>si se env\u00eda un mensaje de difusi\u00f3n UDP dirigido al puerto 5000,</li> <li>o se env\u00eda un mensaje UDP dirigido a la IP del dispositivo y al puerto 5000...</li> </ul> <p>nuestro script lo ver\u00e1 y lo recibir\u00e1.</p> <ul> <li>envia paquete UDP...a la IP...y puerto...</li> </ul> <p> <p> </p> <p></p> <p>Este bloque se utiliza para enviar mensajes UDP a la direcci\u00f3n IP y puerto designados. La direcci\u00f3n IP 255.255.255.255 es una direcci\u00f3n de difusi\u00f3n especial, y se utilizar\u00e1 para acceder a todos los dispositivos IP en la subred local. Esto facilita el env\u00edo de mensajes sin molestarse con la direcci\u00f3n IP espec\u00edfica de cada dispositivo.</p> <p>Ten en cuenta que en MicroBlocks, los mensajes de difusi\u00f3n no son vistos por el dispositivo emisor. Sin embargo, en la MIT AI2 APP, las difusiones son vistas por el tel\u00e9fono emisor.</p> <p>Los mensajes tambi\u00e9n pueden ser enviados utilizando la direcci\u00f3n IP espec\u00edfica y el n\u00famero de puerto UDP del dispositivo de destino, incluso a la propia direcci\u00f3n IP.</p> <p>Direcciones IPv4 reservadas para usos espec\u00edficos</p> <p>127.0.0.0 -&gt; Direcci\u00f3n de loopback o bucle de retorno (la propia interfaz del host)</p> <p>224.0.0.0 -&gt; IP multicast o entrega de datos simultanea a un grupo de nodos receptores.</p> <p>255.255.255.255 -&gt; Difusi\u00f3n (broadcast); se env\u00eda a todas las interfaces en la red</p> <ul> <li>recibe paquete UDP</li> </ul> <p> <p> </p> <p></p> <p>Siempre que se reciba un mensaje UDP, este bloque contendr\u00e1 su contenido. Comprobando si su longitud es mayor que cero, podemos consultar el resultado de las transacciones UDP.</p> <p>Este bloque tambi\u00e9n proporciona una opci\u00f3n booleana de datos binarios que permite recibir cualquier tipo de dato.</p> <p>Hay otros bloques en la biblioteca que no se utilizan en este proyecto aunque se explican por s\u00ed mismos.</p> <ul> <li>det\u00e9n UDP. Detiene el procesado de UDP</li> </ul> <p> <p> </p> <p></p> <ul> <li>direcci\u00f3n IP remota de UDP. El mensaje UDP env\u00eda la direcci\u00f3n IP remota.</li> </ul> <p> <p> </p> <p></p> <ul> <li>puerto remoto de UDP. El mensaje UDP env\u00eda el puerto remoto.</li> </ul> <p> <p> </p> <p></p>"},{"location":"bt/","title":"Comunicaciones Bluetooth","text":""},{"location":"bt/#introduccion","title":"Introducci\u00f3n","text":"<p>Los m\u00f3dulos Bluetooth permiten crear conexi\u00f3n inal\u00e1mbrica serie punto a punto de manera que la forma de trabajar es muy similar a la comunicaci\u00f3n serie por cable. A continuaci\u00f3n vemos lo b\u00e1sico de los m\u00f3dulos m\u00e1s comunes.</p> <p>Bluetooth es una especificaci\u00f3n industrial para Redes Inal\u00e1mbricas de \u00c1rea Personal (WPAN) que posibilita la transmisi\u00f3n de voz y datos entre diferentes dispositivos mediante un enlace por radiofrecuencia en la banda ISM de los 2.4 a 2.485 GHz. Los principales objetivos que se pretenden conseguir con esta norma son:</p> <ul> <li>Facilitar las comunicaciones entre equipos m\u00f3viles.</li> <li>Eliminar los cables y conectores entre estos.</li> <li>Ofrecer la posibilidad de crear peque\u00f1as redes inal\u00e1mbricas y facilitar la sincronizaci\u00f3n de datos entre equipos personales.</li> </ul> <p>Se denomina Bluetooth al protocolo de comunicaciones dise\u00f1ado especialmente para dispositivos de bajo consumo, que requieren corto alcance de emisi\u00f3n y basados en transceptores (dispositivos que cuentan con transmisor y receptor compartiendo parte de la circuiteria) de bajo costo.</p> <p>El hardware que compone el dispositivo Bluetooth est\u00e1 compuesto por dos partes:</p> <ul> <li>un dispositivo de radio, encargado de modular y transmitir la se\u00f1al.</li> <li>un controlador digital, compuesto por una CPU, un procesador de se\u00f1ales digitales (DSP \u2013 Digital Signal Processor) llamado Link Controller (o controlador de Enlace) y de las interfaces con el dispositivo anfitri\u00f3n.</li> </ul> <p>Su logotipo lo vemos en la figura siguiente:</p> <p> <p>. Logotipo Bluetooth con texto y sin texto</p> <p></p>"},{"location":"bt/#bluetooth-v2","title":"Bluetooth V2","text":"<p>Existe un procedimiento definido que se llama Pairing (o emparejamiento) que vincula a dos dispositivos Bluetooth. Cuando vinculamos dos dispositivos Bluetooth, se inicia un proceso en el que ellos se identifican por nombre y direcci\u00f3n interna y se solicitan la clave PIN para autorizar la conexi\u00f3n.</p> <p>Si el emparejamiento se realiza con \u00e9xito, ambos nodos suelen guardar la identificaci\u00f3n del otro y cuando se encuentran cerca se vuelven a vincular sin necesidad de intervenci\u00f3n manual.</p> <p>Para manejar los m\u00f3dulos Bluetooth se utilizan los comandos Hayes o AT, de los que se puede encontrar informaci\u00f3n en este enlace y a continuaci\u00f3n damos algunos b\u00e1sicos:</p> <ul> <li>AT+VERSION: Versi\u00f3n del Firmware.</li> <li>AT+NAMEXXX: Para establecer el nombre que queremos presentar cuando otro dispositivo nos busque.</li> <li>AT+PINXXXX: permite establecer el n\u00famero de identificaci\u00f3n personal, que se requerir\u00e1 para establecer la vinculaci\u00f3n.</li> <li> <p>AT+BAUDX: Permite fijar la velocidad de comunicaci\u00f3n entre el modulo y la consola seg\u00fan los siguientes pares:</p> <p>1 -&gt; 1200 bps | -5 -&gt; 19200 bps</p> <p>2 -&gt; 2400 bps | -6 -&gt; 38400 bps</p> <p>3 -&gt; 4800 bps | -7 -&gt; 57600 bps</p> <p>4 -&gt; 9600 bps | -8 -&gt; 115200 bps</p> </li> </ul> <p>La velocidad por defecto es la de 9600 bps.</p> <p>Los m\u00f3dulos mas conocidos son el HC-05 y HC-06 que son Bluetooth V2 y cuyo aspecto podemos ver en la figura siguiente:</p> <p> <p>. M\u00f3dulos HC-05 y HC-06</p> <p></p>"},{"location":"bt/#bt-40-low-energy-ble-o-smart","title":"BT 4.0, Low Energy (BLE) o Smart","text":"<p>En realidad BLE se introduce como parte de la especificaci\u00f3n Bluetooth 4.0. En la web podemos encontrar mucha informaci\u00f3n sobre el tema habitualmente poco accesible y poco estructurada.</p> <p>Desde aqu\u00ed voy a recomendar el art\u00edculo \u201cIntroduction to Bluetooth Low Energy: A basic overview of key concepts for BLE\u201d publicado por Adafruit donde se hace un repaso de los conceptos en los que se basa BLE y su traducci\u00f3n libre \"Bluetooth BLE: el conocido desconocido\" publicada por Izertis: <ul> <li>Enlace al original: \u201cIntroduction to Bluetooth Low Energy: A basic overview of key concepts for BLE\u201d</li> <li>Enlace a la traducci\u00f3n libre: \"Bluetooth BLE: el conocido desconocido\"</li> </ul> <p> <p>. Logotipo BLE</p> <p></p> <p>B\u00e1sicamente se trata de un nuevo protocolo dise\u00f1ado para reducir en todo lo posible el gran consumo de energ\u00eda de sus predecesores. Generalmente se le conoce como BLE (iniciales de Bluetooth Low Energy) o Bluetooth LE o tambi\u00e9n como Bluetooth Smart y tienen un consumo t\u00edpico que podemos cifrar entre los 10 y 15 mA. Otra de sus principales novedades radica en que este m\u00f3dulo si es utilizables con dispositivos iOS.</p> <p>El BLE es un subconjunto del est\u00e1ndar Bluetooth v4.0 que dispone de una pila de protocolos en referencia a la capa OSI (en ingl\u00e9s, Open Systems Interconnection) completamente nueva y orientada a conexiones sencillas en aplicaciones de muy baja potencia que suelen funcionar con pilas o bater\u00edas.</p> <p>La pila de protocolos para Bluetooth Low Energy sigue la estructura definida en la figura siguiente.</p> <p> <p>. Pila de protocolos para BLE</p> <p></p> <p>El controlador aloja las capas inferiores de la pila del protocolo y tambi\u00e9n la radio. El Hots contiene las capas superiores de la pila de protocolos. Por encima de ambas estar\u00eda la aplicaci\u00f3n de usuario que es la que interact\u00faa con la pila de protocolos. La ventaja es que todas estas capas se pueden implementar en un solo chip o dividir en varios y conectarlos a trav\u00e9s de una capa de comunicaciones como UART, USB o SPI.</p> <ul> <li> <p>El controlador contiene las capas: Interfaz de controlador de host (HCI), Capa de enlace (LL) y Capa f\u00edsica (PHY)</p> <ul> <li>En la capa f\u00edsica (physical layer) se implementa toda la circuiteria de comunicaciones. La tecnolog\u00eda BLE puede usar hasta 40 canales de 2MHz en la banda ISM. El est\u00e1ndar emplea la t\u00e9cnica \u201cfrequency hopping\u201d o \u201csaltos en frecuencia\u201d, siguiendo una secuencia de saltos pseudo-aleatorios entre los canales frecuenciales mencionados que ofrece un alto grado de robustez frente a interferencias.</li> <li>La capa de enlace (link layer), se encarga de gestionar caracter\u00edsticas como los requerimientos temporales del est\u00e1ndar, chequeo de mensajes y reenv\u00edo de mensajes err\u00f3neos recibidos, gesti\u00f3n, filtrado de direcciones etc. Adem\u00e1s ofrece la definici\u00f3n de roles (Advertiser, Scanner, Master and Slave) que permiten identificar de forma l\u00f3gica el rol de cada dispositivo en el proceso de coElmunicaci\u00f3n. El nivel LL es del mismo modo responsable de procesos de control como el cambio de par\u00e1metros de la conexi\u00f3n o la encriptaci\u00f3n.</li> <li>el Host Controller o HCI es un protocolo est\u00e1ndar que permite que la comunicaci\u00f3n entre un host y un controlador se lleve a cabo a trav\u00e9s de un interfaz serie. A modo de ejemplo, en la mayor\u00eda de smartphones u ordenadores el host y la aplicaci\u00f3n corren en la CPU principal mientras que el controlador est\u00e1 situado en hardware espec\u00edfico y separado, conectado mediante UART o USB. El est\u00e1ndar Bluetooth define HCI como el conjunto de comandos y eventos para la interacci\u00f3n de ambas partes (host y controlador).</li> </ul> </li> <li> <p>El host contiene las siguientes capas: Perfil de acceso gen\u00e9rico (GAP), Perfil de atributo gen\u00e9rico (GATT), Protocolo de adaptaci\u00f3n y control de enlace l\u00f3gico (L2CAP), Protocolo de atributos (ATT), Gerente de seguridad (SM) y la Interfaz de controlador de host (HCI).</p> <ul> <li>La capa L2CAP (Logic Link Control and Adaptation Protocol), se responsabiliza de dos tareas fundamentales en un proceso de comunicaci\u00f3n. En primer lugar, el proceso de multiplexaci\u00f3n, es decir, la capacidad de dar formato a mensajes provenientes de las capas OSI superiores y encapsularlos en paquetes est\u00e1ndar BLE as\u00ed como el proceso inveM\u00f3dulrso.</li> <li>Para BLE, la capa L2CAP es la encargada de dar acceso y soporte a los dos protocolos fundamentales. Por un lado, ATT (Attribute Protocol), un protocolo basado en atributos presentados por dispositivo, con arquitectura cliente-servidor, que permite el intercambio de informaci\u00f3n. Por otro lado, SMP (Security Manager Protocol), protocolo que proporciona un framework para generar y distribuir claves de seguridad entre dos dispositivos.</li> <li>En el nivel m\u00e1s alto de la capa de protocolos, encontraremos de forma paralela las capas GAP y GATT. Esta primera, GAP (Generic Acces Profile), permite que un dispositivo sea visible hacia el resto de dispositivos y adem\u00e1s determina como puede interactuar un dispositivo entre otro. Establece distintas normas y conceptos para estandarizar las operaciones de m\u00e1s bajo nivel como: <ul> <li>Roles de interacci\u00f3n</li> <li>Modos de operaci\u00f3n y transici\u00f3n entre ellos</li> <li>Procedimientos para establecimiento de comunicaci\u00f3n</li> <li>Modos de seguridad y procedimientos</li> </ul> </li> </ul> </li> <li> <p>Al otro lado, GATT (Generic Attribute Profile), que define como dos dispositivos BLE transfieren informaci\u00f3n. Este proceso tiene lugar cuando dos dispositivos han superado la fase de establecimiento de comunicaci\u00f3n (controlada por GAP) y comienza la transferencia de informaci\u00f3n pudiendo ser de forma bidireccional.</p> </li> </ul> <p>En dispositivos con microcontrolador ESP32 con BLE integrado simplemente comunicamos con el dispositivo indicando el nombre del mismo.</p>"},{"location":"bt/#aplicaciones-bluetooth","title":"Aplicaciones Bluetooth","text":"<p>Existen muchas aplicaciones y en todas, antes de usar cualquier aplicaci\u00f3n, debemos emparejar el BLE de la ESP32 con nuestro m\u00f3vil. Adem\u00e1s, una vez emparejados los dispositivos, debemos establecer la conexi\u00f3n entre ambos dentro de la APP con la que pretendemos trabajar. Este punto puede presentarnos alguna dificultad si no tenemos correctamente configuradas las opciones de la APP. Veamos como proceder con un m\u00f3vil que tiene instalado Android versi\u00f3n 14 UKQ1.230917.001.</p> <p>Opciones de APP</p> <p>Localizamos el icono de la aplicaci\u00f3n y lo mantenemos pulsado hasta que aparezcan las opciones de \"informaci\u00f3n\" y \"borrado\" de la APP.</p> <p> <p>. Acceso a informaci\u00f3n de la APP</p> <p></p> <p>Pulsamos sobre la \"i\" y nos aparece la pantalla de \"Informaci\u00f3n de la aplicaci\u00f3n\":</p> <p> <p>. Informaci\u00f3n de la informaci\u00f3n de la APP</p> <p></p> <p>Desde la pantalla anterior podemos acceder a \"Otros permisos\" que tiene dicha aplicaci\u00f3n. Estos pueden tener el aspecto que vemos en la imagen siguiente:</p> <p> <p>. Permisos de la APP</p> <p></p> <p>En estas condiciones no podemos establecer una conexi\u00f3n entre el dispositivo vinculado y el m\u00f3vil. Debemos establecer los permisos de la siguiente forma:</p> <p> <p>. Permisos de la APP</p> <p></p> <p>Existen muchas aplicaciones capaces de actuar como apps que permiten transmitir datos entre dispositivos Bluetooth. Vamos a ver brevemente de Google Play Store las siguientes:</p>"},{"location":"bt/#bluetooth-terminal-qwerty","title":"Bluetooth Terminal Qwerty","text":"<p>Bluetooth Terminal Qwerty, una apk con una interface muy simple y f\u00e1cil de configurar, basta conectarse con el dispositivo emparejado y comenzar a enviar comandos.</p> <p> <p>. Bluetooth Terminal Qwerty</p> <p></p>"},{"location":"bt/#arduino-bluetooth-controller","title":"Arduino Bluetooth Controller","text":"<p>Arduino Bluetooth Controller es una aplicaci\u00f3n que le permite controlar su placa arduino (y placas similares) a trav\u00e9s de Bluetooth.</p> <p> <p>. Logo Arduino Bluetooth Controller</p> <p></p> <p>Al lanzar la aplicaci\u00f3n se muestra una imagen y tras unos instantes aparece el men\u00fa gr\u00e1fico de la aplicaci\u00f3n. En la parte superior derecha tenemos el icono para conectar a un dispositivo.</p> <p> <p>. Arduino Bluetooth Controller</p> <p></p> <p>En la imagen siguiente vemos el modo terminal de la aplicaci\u00f3n.</p> <p> <p>. Modo terminal de Arduino Bluetooth Controller</p> <p></p>"},{"location":"bt/#arduino-bluetooth-control","title":"Arduino Bluetooth Control","text":"<p>Arduino Bluetooth Control tambi\u00e9n es una aplicaci\u00f3n que te permite controlar la placa arduino (y placas similares) a trav\u00e9s de Bluetooth.</p> <p> <p>. Logo Arduino Bluetooth Control</p> <p></p> <p>Se lanza la app, se escoge dispositivo y selecciona el modo terminal para estar en una situaci\u00f3n parecida a la de las otras aplicaciones.</p> <p> <p>. Arduino Bluetooth Control</p> <p></p>"},{"location":"bt/#serial-bluetooth-terminal","title":"Serial Bluetooth Terminal","text":"<p>Aplicaci\u00f3n para Android compatible con Bluetooth cl\u00e1sico y Bluetooth LE o Bluetooth Low Energy o BLE o Bluetooth Smart.</p> <p> <p>. Logo Serial Bluetooth Terminal</p> <p></p> <p>Seguimos el proceso habitual de emparejar la ESP32 micro:STEAMakers con nuestro m\u00f3vil:</p> <p> <p>. Proceso para emparejar dispositivos</p> <p></p> <p>Abrimos la APP, que por defecto nos muestra la pantalla siguiente:</p> <p> <p>. Pantalla inicial Serial Bluetooth Terminal</p> <p></p> <p>Si abrimos el men\u00fa de la parte izquierda vemos una pantalla con opciones. Entramos en \"Devices\" para que se muestren los dispositivos disponibles y as\u00ed conectarnos con el dispositivo que hemos emparejado antes:</p> <p> <p>. Conexi\u00f3n con dispositivo</p> <p></p> <p>En la pantalla de la derecha vemos que podemos volver al terminal mostrado en la primera p\u00e1gina y escoger el tipo de Bluetooth con el que vamos a trabajar, BLE en nuestro caso. Pulsamos sobre el dispositivo marcado y se establece la conexi\u00f3n, indic\u00e1ndose esto mediante mensajes y por la posici\u00f3n del conector, y se retorna a la pantalla del terminal que vemos a continuaci\u00f3n:</p> <p> <p>. Conexi\u00f3n con dispositivo establecida</p> <p></p> <p>Con esto el sistema est\u00e1 listo para enviar datos de la placa al m\u00f3vil y viceversa.</p>"},{"location":"mod_colores/","title":"Modelo de colores","text":"<p>Seg\u00fan Wikipedia un modelo de colores es un modelo matem\u00e1tico abstracto que permite representar los colores en forma num\u00e9rica, utilizando t\u00edpicamente tres o cuatro valores o componentes crom\u00e1ticos (por ejemplo RGB y CMYK son modelos de colores). Es decir, un modelo de colores sirve en una aplicaci\u00f3n que asocia a un vector num\u00e9rico un elemento en un espacio de color.</p> <p>En el enlace anterior tenemos mayor informaci\u00f3n de los modelos existentes, de los que nosotros vamos a ver los dos que habitualmente se utilizan en programaci\u00f3n de placas microcontroladas, el RGB y el HSV.</p>"},{"location":"mod_colores/#modelo-rgb","title":"Modelo RGB","text":"<p>El modelo de color RGB utiliza los componentes RGB (Red, Green, Blue) o RVA (Rojo, Verde, Azul) para definir la cantidad de luz de cada color en un color determinado. En una imagen cada componente se expresa como un n\u00famero entre 0 y 255, lo que significa que hay 256 grados de cada color primario. Si multiplicamos todos los grados de color disponibles por canal se obtiene \\(256x256x256 = 16777216\\), es decir mas de 16,7 millones de combinaciones de color.</p> <p>El ojo humano sit\u00faa su espectro visible entre la lu6z violeta y la luz roja estim\u00e1ndose que puede distinguir hasta 10 millones de colores. El funcionamiento del ojo de manera resumida es: la c\u00f3rnea inclina la luz hacia la pupila, esta es la que regula la cantidad de luz que llega al cristalino. El cristalino se encarga de enfocar la luz en la retina, la capa de c\u00e9lulas nerviosas situada en el fondo del ojo. En la retina hay dos tipos de c\u00e9lulas, los conos (se estimulan en condiciones de buena luminosidad) y los bastones (se estimulan en condiciones de baja luminosidad). Los conos humanos tienen habitualmente tres tipos de pigmentos: rojo, verde y azul. </p> <p>Es un modelos de color aditivo, luego el color se produce a partir de la luz transmitida. RGB se utiliza por lo tanto en monitores, donde las luces roja, azul y verde se mezclan de distintas formas para reproducir un amplio rango de colores. Cuando las luces roja, azul y verde se combinan en su m\u00e1xima intensidad, el ojo percibe el color resultante como blanco. En teor\u00eda, los colores mezclados siguen siendo rojo, azul y verde, pero los pixeles del monitor se encuentran demasiado juntos para que nuestro ojo pueda diferenciar los tres colores. Cuando el valor de cada componente es 0, indica que hay una ausencia de luz y el ojo percibe el color negro.</p> <p> <p></p> <p></p>"},{"location":"mod_colores/#modelo-hsl","title":"Modelo HSL","text":"<p>El modelo HSL o a veces HSI (siglas del ingl\u00e9s Hue, Saturation, Lightness o Intensity; traducido por, \u2018matiz o tono, saturaci\u00f3n, luminosidad o intensidad\u2019), define un modelo de color en t\u00e9rminos de sus componentes constituyentes.</p> <p>En el modelo de color HSV, un color se define por su matiz o tono (H), su saturaci\u00f3n (S) y su luminosidad o intensidad (L). Ahora las siglas no significan colores como en RGB, sino par\u00e1metros.</p> <p>La variedad de colores se obtiene cambiando los tres canales de color de tono (H), saturaci\u00f3n (S) y luminosidad (L) y superponi\u00e9ndolos entre s\u00ed. Este modo de color cubre los colores que puede percibir la visi\u00f3n humana.</p> <p>Se suele representar mediante la rueda de color, como vemos a continuaci\u00f3n:</p> <p> <p></p> <p></p>"},{"location":"mod_colores/#tono-matiz-o-hue-h","title":"Tono, matiz o Hue (H)","text":"<p>En el c\u00edrculo crom\u00e1tico el grado 0 (o 360\u00ba si hemos dado una vuelta completa) del Hue es el color rojo. El circulito rodeado corresponde al \u00e1ngulo en la rueda de color. Cada \u00e1ngulo representa un color. En esa posici\u00f3n la saturaci\u00f3n S por defecto toma su valor m\u00e1ximo de 100, y el brillo (L) es de 50. Nos podemos mover con estas condiciones por la rueda y obtener los distintos colores para esos valores de saturaci\u00f3n o brillo.</p> <p> <p></p> <p></p>"},{"location":"mod_colores/#saturacion-o-saturation-s","title":"Saturaci\u00f3n o Saturation (S)","text":"<p>Indica la intensidad de un tono concreto. Los valores varian entre 0 y 100, siendo 100 el m\u00e1ximo de saturaci\u00f3n posible y 0 el m\u00ednimo, que dar\u00e1 como resultado, gris. El par\u00e1metro cambia sus valores moviendose dentro del tri\u00e1ngulo en la l\u00ednea del d\u00edametro del c\u00edrculo que corresponde a la posici\u00f3n del \u00e1ngulo determinado por H.</p> <p> <p></p> <p></p> <p>Observamos que al acercarnos al gris el valor de H se restablece a su valor por defecto. Hasta ese punto el tono se mantiene en el valor definido.</p>"},{"location":"mod_colores/#luminosidad-o-lightness-l","title":"Luminosidad o Lightness (L)","text":"<p>El par\u00e1metro se refiere a como de claro u oscuro es un color. Si queremos aclarar un color nos moveremos hacia el blanco y si quiero oscurecerlo hacia el negro.</p> <p> <p></p> <p></p> <p>Hay un par\u00e1metro que suele acompa\u00f1ar a la rueda de color que es el Alfa (A), que puede variar entre 0 y 100 y se refiere al grado de opacidad del color, correspondiendo 100 a totalmente opaco y 0 a totalmente transparente.</p>"},{"location":"mod_colores/#convertir-rgb-a-hsl","title":"Convertir RGB a HSL","text":"<p>Nos vamos a basar en un ejemplo descrito por los valores R=90, G=220, B=80 correspondiente a un tono verde oscuro.</p> <p> <p></p> <p></p> <ul> <li>Paso 1. M\u00e1ximo y M\u00ednimo. Convertimos los valores RGB a valores en el rango 0-1 dividiendo por 255 cada valor.</li> </ul> <p> <p>\\(R = \\dfrac{90}{255}= 0.353 \\space; \\space G = \\dfrac{220}{255}= 0.863 \\space; \\space B = \\dfrac{80}{255}= 0.314\\)</p> <p>\\(\\boxed{R = 0.353 \\space; \\space G = 0.863 \\space(Max) \\space; \\space B = 0.314 \\space(Min)}\\)</p> <p></p> <ul> <li>Paso 2. Luminancia. Calculamos la Luminancia sumando los valores m\u00e1ximo y m\u00ednimo obtenidos en el paso 1 y lo dividimos por 2.</li> </ul> <p> <p>\\(L \\space = \\space \\dfrac{0.863 + 0.314}{2} \\space= \\space 0.5885 \\space\\approx59 \\%\\)</p> <p>\\(\\boxed{L \\space = \\space 0.5885 \\space \\approx 59 \\%}\\)</p> <p></p> <ul> <li>Paso 3. Saturaci\u00f3n. A la hora de calcular la saturaci\u00f3n S tendremos en cuenta que:</li> </ul> <ul> <li>Si los valores m\u00e1ximo y m\u00ednimo son iguales: No hay saturaci\u00f3n. <li>Si todos los valores RGB son iguales: Tono gris mas o menos oscuro o claro dependiendo de la luminosidad.</li> <li>Si no hay saturaci\u00f3n el Tono ser\u00e1 0\u00ba.</li> <p>Si no se da alguna de las condiciones anteriores sabemos que hay Saturaci\u00f3n, que se calcula seg\u00fan sea el nivel de Luminancia:</p> <p>\\(\\Rightarrow\\) Si \\(L \\leq 0.5\\)</p> <p> \\(S = \\dfrac{Max-Min}{Max+Min}\\) </p> <p>\\(\\Rightarrow\\) Si \\(L &gt; 0.5\\)</p> <p> \\(S = \\dfrac{Max-Min}{2.0-Max-Min}\\) <p>\\(S = \\dfrac{0.863-0.314}{2-0.863-0.314} = \\dfrac{0.549}{0.823}=0.667 \\approx 67 \\%\\)</p> <p>\\(\\boxed{S = 0.667 \\approx 67 \\%}\\)</p> <p></p> <ul> <li>Paso 4. Tono. La f\u00f3rmula del Tono depende de qu\u00e9 canal de color RGB es el valor m\u00e1ximo. Las tres f\u00f3rmulas diferentes son:</li> </ul> <p>\\(\\Rightarrow\\)  Si Rojo es el m\u00e1ximo, entonces:</p> <p> \\(H = \\dfrac{G-B}{Max-Min}\\) </p> <p>\\(\\Rightarrow\\)  Si Verde es el m\u00e1ximo, entonces:</p> <p> \\(H = 2.0 + \\dfrac{B-R}{Max-Min}\\) <p>\\(H = 2.0 + \\dfrac{0.314-0.353}{0.863-0.314} = 2.0 + \\dfrac{(-0.039)}{0.549} = 1.929\\)</p> <p>\\(\\boxed{H=1.929}\\) </p> <p>\\(\\Rightarrow\\)  Si Azul es el m\u00e1ximo, entonces:</p> <p> \\(H = 4.0 + \\dfrac{R-G}{Max-Min}\\) </p> <p>El valor obtenido de H lo multiplicamos por 60 para convertirlo en grados en el c\u00edrculo crom\u00e1tico. Si resulta un valor negativo de H le sumamos 360.</p> <p> <p>\\(H = 1.929 \\times 60 = 115.74 \\approx 116 \\space grados\\)</p> <p>\\(\\boxed{H=116 \\space grados}\\)</p> <p></p> <p>Resultado final:</p> <p> R = 90, G = 220, B = 80 <p>H = 116, S = 67, L = 59 </p>"},{"location":"mod_colores/#convertir-hsl-a-rgb","title":"Convertir HSL a RGB","text":"<p>En el mismo sitio en que hemos basado la conversi\u00f3n de RGB a HSL de Nikolai Waldman est\u00e1 documentado como hacerlo a la inversa, pero nosotros no lo vamos a hacer de este modo.</p> <p>Se encuentran facilmente en la web p\u00e1ginas con calculadoras que permiten convertir de un modelo a otro con tan solo introducir los valores. Algunas incluso indican las f\u00f3rmulas de c\u00e1lculo, que usualmente est\u00e1n basadas en la entrada HSL and HSV de la Wikipedia. A t\u00edtulo de ejemplo aqu\u00ed pongo la de rapidtables, que ofrece muchas calculadoras en l\u00ednea gratuitas</p> <p>Hay una forma de hacerlo a partir de un programa libre como es Inkscape, publicado bajo licencia GNU General Public License, version 3 y que hemos utilizado para las animaciones donde se han explicado los conceptos y donde adem\u00e1s se pueden obtener otros datos y por supuesto modificarlos.</p> <p>Es muy sencillo de utilizar y nos ofrece adem\u00e1s otras posibilidades interesantes. Veamos como llegar a ello una vez abierto Inkscape con un archivo en blanco.</p> <p>Dibujamos cualquier cosa y abrimos las opciones de Relleno y borde del objeto y desde ah\u00ed ya podemos cambiar el modelo de color, activar la rueda, mover la rueda o los valores lineales, volver a cambiar de modelo, etc y se nos ir\u00e1n mostrando los valores convetidos de uno a otro, como se observa en la animaci\u00f3n siguiente cuando cambiamos del modelo HSL a RGB.</p> <p> <p> </p> <p></p>"},{"location":"mod_colores/#modelo-hsv","title":"Modelo HSV","text":"<p>El modelo HSV (Hue, Saturation, Value \u2013 Matiz, Saturaci\u00f3n, Valor), es tambi\u00e9n llamado HSB (Hue, Saturation, Brightness \u2013 Matiz, Saturaci\u00f3n, Brillo), define un modelo de color en t\u00e9rminos de sus componentes.</p> <p>El Matiz o Hue se representa como un \u00e1ngulo de 0 a 360\u00ba correspondiendo cada valor a un color. En una rueda de colores se puede representar de la siguiente forma:</p> <p> <p> </p> <p></p> <p>Si asociamos con RGB vemos que el rojo corresponde a un \u00e1ngulo de 0\u00ba, el verde a 120\u00ba y el azul a 240\u00ba. Los colores entre estos tres \u00e1ngulos divisorios corresponden a niveles de mezcla de los dos colores extremos. Por ejemplo, justo en la mitad entre el rojo y el verde estar\u00eda la mezcla de ambos colores que corresponde al amarillo.</p> <p>La Saturaci\u00f3n puede variar entre 0 y 100% y representa el porcentaje de brillo. En la animaci\u00f3n siguiente vemos el funcionamiento de la rueda de color y del par\u00e1metro de saturaci\u00f3n en el programa Inkscape.</p> <p> <p> Rueda de colores HSV y Saturaci\u00f3n</p> <p></p> <p>El Valor tambi\u00e9n puede variar entre 0 y 100%, correspondiendo el 0 siempre a negro y el resto de valores un color mas o menos saturado. En la animaci\u00f3n siguiente vemos el funcionamiento del par\u00e1metro Valor en el programa Inkscape.</p> <p> <p> Rueda de colores HSV y Valor</p> <p></p> <p>El propio Inkscape no puede servir para convertir RGB a HSV y viceversa. En la web tambi\u00e9n podemos encontrar calculadoras que lo hacen indicando incluso las f\u00f3rmulas de conversi\u00f3n y dandonos una previsualizaci\u00f3n del color. A continuaci\u00f3n, a t\u00edtulo de ejemplo, ponemos enlaces a dos de ellas:</p> <ul> <li>Conversor de RapidTables en ingl\u00e9s.</li> <li>Conversor de peko-step en espa\u00f1ol.</li> </ul>"},{"location":"previos/","title":"Conocimientos t\u00e9cnicos previos","text":""},{"location":"previos/#las-comunicaciones-i2c","title":"Las comunicaciones I2C","text":"<p>Las siglas I2C provienen del ingl\u00e9s Inter-Integrated Circuit (Circuito inter-integrado) y vamos a explicar un poco en que consiste este sistema de conexionado.</p> <p>Bus conocido por las siglas I2C, IIC o I\u00b2C, es un bus serie de datos desarrollado en 1982 por Philips Semiconductors (hoy NXP Semiconductors, parte de Qualcomm). Se utiliza principalmente internamente para la comunicaci\u00f3n entre diferentes partes de un circuito, por ejemplo, entre un controlador y circuitos perif\u00e9ricos integrados. Posteriormente fue adoptado progresivamente por otros fabricantes hasta convertirse en un est\u00e1ndar del mercado con miles de circuitos integrados de diferentes fabricantes.</p> <p>I2C tambi\u00e9n se denomina TWI (Two Wired Interface) \u00fanicamente por motivos de licencia, denominaci\u00f3n introducida por Atmel. No obstante, la patente caduc\u00f3 en 2006, por lo que actualmente no hay restricci\u00f3n sobre el uso del t\u00e9rmino I2C.</p> <p>El bus I2C requiere \u00fanicamente dos cables o lineas de se\u00f1al para su funcionamiento, uno para la se\u00f1al de reloj (SCL, Serial Clock) y otro para el env\u00edo de datos (SDA, Serial Data). Ambas l\u00edneas precisan resistencias de pull-up hacia Vcc. Cualquier dispositivo conectado a estas l\u00edneas es de drenador o colector abierto (Open Collector), lo cual en combinaci\u00f3n con las resistencias pull-up, crea un circuito Wired-AND. En la imagen siguiente vemos el diagrama b\u00e1sico de conexionado del bus con algunos ejemplos de dispositivos. La se\u00f1al de reloj siempre es generada por el circuito que act\u00faa como Master.</p> <p> </p> <p>Para ser reconocido en el bus, cada dispositivo dispone de una direcci\u00f3n, que se emplea para acceder a cada uno de ellos de forma individual. Esta direcci\u00f3n puede ser fijada por hardware, en cuyo caso se pueden modificar los \u00faltimos 3 bits mediante \u201cjumpers\u201d o microinterruptores (ejemplo de la matriz de 8x8), o por software.</p> <p>En general, cada dispositivo conectado al bus debe tener una direcci\u00f3n \u00fanica. Si tenemos varios dispositivos similares tendremos que cambiar la direcci\u00f3n o, en caso de no ser posible, implementar un bus secundario.</p> <p>El bus I2C tiene una arquitectura de tipo master-slave, lo que indica que el master es el encargado de controlar al resto de dispositivos tipo slave con los que se comunica y que se comunican con el, teniendo siempre el marte prioridad absoluta. El dispositivo master es el que inicia la comunicaci\u00f3n con los slaves. Los slaves no pueden iniciar la comunicaci\u00f3n (el master tiene que preguntarles), ni hablar entre si directamente.</p> <p>El bus I2C debe ser por lo tanto s\u00edncrono, es decir debe existir una se\u00f1al de reloj que controle las comunicaciones. Es el master el que proporciona la se\u00f1al de reloj, que mantiene sincronizados a todos los dispositivos del bus. De esta forma, se elimina la necesidad de que cada dispositivo tenga su propio reloj, de tener que acordar una velocidad de transmisi\u00f3n y mecanismos para mantener la transmisi\u00f3n sincronizada como en UART o SPI. En la imagen vemos un cronograma ejemplo del funcionamiento del sistema.</p> <p> </p> <p>El protocolo de comunicaci\u00f3n I2C sigue la siguiente secuencia:</p> <ul> <li>Primero, el master genera la se\u00f1al de reloj del bus (SCL).</li> <li>Se inicia la comunicaci\u00f3n por orden del master al establecer la condici\u00f3n de START, que se produce cuando SDA pasa de uno a cero y se mantiene en cero durante un tiempo.</li> <li>El master direcciona a los slaves.</li> <li>El master indica si se va a leer o escribir.</li> <li>El slave direccionado responde con una se\u00f1al de conformidad ACK (acknowledge).</li> <li>Se transmite los datos byte a byte desde SDA al receptor. Por cada pulso desde SCL se transmite un bit de informaci\u00f3n.</li> <li>El destinatario de la informaci\u00f3n responde con una se\u00f1al de conformidad ACK.</li> <li>Se acaba la comunicaci\u00f3n cuando el master establece la condici\u00f3n de STOP, que se produce cuando SDA, por orden del master pasa de cero a uno y se mantiene en uno durante un tiempo.</li> </ul> <p>Son muchos los dispositivos I2C que se pueden direccionar por este bus I2C, siendo lo m\u00e1s com\u00fan en los dispositivos para I2C que utilicen direcciones de 7 bits, aunque existen dispositivos de 10 bits, pero es un caso raro. Una direcci\u00f3n de 7 bits implica que se pueden poner hasta 128 (27) dispositivos sobre un bus I2C. Hemos visto que las direcciones son de 8 bits y esto es porque el bit extra de los 7 de la direcci\u00f3n lo emplea el master para informar al slave si va a leer o escribir. Si el bit de lectura/escritura es cero, el dispositivo master est\u00e1 escribiendo en el slave. Si el bit es 1 el master est\u00e1 leyendo desde el slave. La direcci\u00f3n de 7 bit se coloca en los 7 bits m\u00e1s significativos del byte y el bit de lectura/escritura es el bit menos significativo.</p>"},{"location":"previos/#pantalla-oled","title":"Pantalla OLED","text":"<p>OLED es la abreviatura de (Organic Light-Emitting Diode) o diodo emisor de luz org\u00e1nico. Se dice org\u00e1nico debido a una pel\u00edcula de carbono que se encuentra en el interior del panel, detr\u00e1s del cristal protector. Cuando se colocan varias pel\u00edculas org\u00e1nicas entre dos conductores se puede hacer que cada pixel se ilumine de forma individual, haciendo muy eficiente este tipo de pantallas. Es decir, una pantalla OLED emite luz brillante propia al pasar corriente el\u00e9ctrica.</p> <p>Para su funcionamiento van ensambladas junto a un controlador CMOS SSD1306 y la electr\u00f3nica necesaria para hacerla funcionar. Este controlador se encarga de obtener los datos y enviarlos a la OLED.</p> <p>En la web se pueden encontrar muchas referencias que describen como trabaja. Aqu\u00ed daremos una breve descripci\u00f3n de lo que nos interesa.</p> <p>La coordenada X=0, Y=0 se corresponde con el extremos superior izquierdo y los ejes se sit\u00faan de la siguiente forma:</p> <p> </p> <p>Desde el origen de coordenadas, cada unidad que a\u00f1adimos se corresponde con un desplazamiento de un pixel de la pantalla OLED.</p> <p>En STEAMakersBlocks el bloque principal de escritura en pantalla tien la forma y las partes que podemos ver en la imagen siguiente:</p> <p> </p> <p>El espacio de escritura del texto puede servir para ver los datos que devuelve alg\u00fan sensor, para lo que se puede situar el bloque en el espacio destinado al texto (en la imagen siguiente se utiliza un bloque para ver los datos recogidos por un sensor de temperatura LM35):</p> <p> </p> <p>Tambi\u00e9n vamos a ver las herramientas disponibles en STEAMakersBlocks para el trabajo con gr\u00e1ficos. Para poder mostrar gr\u00e1ficos debemos generar un mapa de bits que indique que pixeles estar\u00e1n apagados y cuales encendidos. STEAMakersBlocks dispone de una herramienta visual (OLED - Bitmap Data) que nos permite generar el c\u00f3digo de los bitmaps y de un bloque que nos permite mostrarlos. El bloque para mostrar un bitmap es el de la imagen siguiente:</p> <p> </p> <p>A la herramienta OLED - Bitmap Data podemos acceder por cualquiera de los m\u00e9todos que vemos en la imagen siguiente:</p> <p> </p> <p>En la imagen siguiente vemos la pantalla OLED - Bitmap Data y la explicaci\u00f3n de sus partes.</p> <p> </p> <p>La copia de datos se realiza en el apartado correspondiente (el cuadro de entrada de la derecha) del bloque mostrar un bitmap.</p> <p>Puedes marcar directamente los p\u00edxeles que desees sobre el dibujo de la pantalla y estos ser\u00e1n los que se activar\u00e1n en la pantalla OLED conectada a la placa.</p> <p> </p> <p>O bien, puedes subir una imagen desde \u201cElegir archivos\u201d (preferentemente ajustado a las dimensiones 128\u00d764 px, aunque cualquier imagen que subas se adaptar\u00e1 a esta proporci\u00f3n):</p> <p> </p> <p>La imagen siguiente resume todo el proceso que se puede seguir desde cargar la imagen hasta completar el bloque:</p> <p> </p>"},{"location":"previos/#pantalla-lcd-1602-i2c","title":"Pantalla LCD 1602 I2C","text":"<p>Una pantalla LCD (del ing\u00e9s, Liquid Cristal Display) de 2 l\u00edneas de 16 caracteres tiene el aspecto y la distribuci\u00f3n de pines que vemos en la imagen siguiente.</p> <p> </p> <p>Es evidente que deber\u00edamos utilizar bastantes patillas de nuestra placa UNO para su control. En la imagen siguiente se muestra el conexionado m\u00ednimo necesario en una pantalla de este tipo: 4 bits para datos y dos se\u00f1ales de control En (Enable) y Rs (Register select). La conexi\u00f3n RW la ponemos a GND. Adem\u00e1s se debe a\u00f1adir una resistencia ajustable o un potenci\u00f3metro para regular el contraste de la pantalla.</p> <p> </p> <p>Es preferible utilizar las que tienen el aspecto que vemos en la imagen siguiente:</p> <p> </p> <p>En realidad el conjunto que vemos en la imagen anterior no es mas que una LCD 2x16 a la que se ha incorporado un m\u00f3dulo adaptador de LCD a I2C. Este modulo est\u00e1 especialmente dise\u00f1ado para poder soldarlo directamente a la LCD y convertirla as\u00ed en un dispositivo I2C que adem\u00e1s ya lleva incorporado el potenciometro de ajuste de contraste.</p> <p>Esta pantalla requiere cuatro cables para establecer las conexiones, dos cables SDA (datos) y SCL (reloj) para el bus de comunicaciones I2C y los dos cables de alimentaci\u00f3n VCC y GND.</p> <p>La direcci\u00f3n I2C por defecto de este tipo de m\u00f3dulos puede ser 0x3F o en otros casos 0x27, e incluso hay modelos en los que se puede cambiar. Para un correcto control es muy importante identificar correctamente la direcci\u00f3n I2C de nuestro modulo, que en el caso de la que incorpora el kit TdR STEAM es la 0x27, pues de otra forma nuestro programa no funcionar\u00e1 correctamente.</p> <p>Una LCD 1602 I2C es muy sencilla de controlar a partir de los bloques que nos proporciona STEAMakersBlocks. En la imagen siguiente ponemos como ejemplo los bloques para imprimir un texto o variable en un par fila-columna determinado.</p> <p> </p> <p>Seguidamente se muestra el sistema de distribuci\u00f3n de filas y columnas.</p> <p> </p>"},{"location":"previos/#escanear-dispositivos-i2c","title":"Escanear dispositivos I2C","text":"<p>Si no conocemos la direcci\u00f3n especifica de nuestro m\u00f3dulo podemos utilizar un peque\u00f1o programa que llamaremos Escaner-I2C y que se encargar\u00e1 de identificar la direcci\u00f3n I2C y todos los dispositivos I2C conectados a nuestra placa. Debemos crear un proyecto, en esta ocasi\u00f3n, de tipo \"Arduino UNO\" para tener disponible el men\u00fa I2C que nos de acceso al bloque \"Escanear dispositivos I2C...\" tal y como vemos en la imagen siguiente:</p> <p> </p> <p>Un sencillo programa como el de la imagen siguiente nos permite ver los dispositivos I2C conectados y su direcci\u00f3n f\u00edsica asociada. El programa est\u00e1 disponible como Escaner-I2C.</p> <p> </p> <p>Si conectamos la consola el resultado de tener la placa TdR STEAM es el de la imagen siguiente:</p> <p> </p>"},{"location":"previos/#cambiar-la-direccion-fisica-del-dispositivo-i2c","title":"Cambiar la direcci\u00f3n f\u00edsica del dispositivo I2C","text":"<p>Esta tarea nos va a resultar especialmente \u00fatil si disponemos de LCDs I2C con una direcci\u00f3n fijada de f\u00e1brica y queremos conectar varias de ellas en nuestro proyecto. La parte posterior de la LCD 1602 de Keyestudio tiene el aspecto de la imagen siguiente. Nos fijaremos especialmente en los tres grupos de agujeros enmarcados en rojo. Aunque en este caso no vienen nombrados los vamos a denominar A0, A1 y A2 de izquierda a derecha.</p> <p> </p> <p>La direcci\u00f3n por defecto de f\u00e1brica en este caso es la 0x27, pero se puede cambiar alterando la situaci\u00f3n de conexionado de estos agujeros entre si seg\u00fan la tabla siguiente:</p> A2 A1 A0 Direcci\u00f3n 0 0 0 0x27 0 0 1 0x26 0 1 0 0x25 0 1 1 0x24 1 0 0 0x23 1 0 1 0x22 1 1 0 0x21 1 1 1 0x20 <p>Para establecer los unos de la tabla anterior basta con cortocircuitar los dos pads correspondientes. En la imagen siguiente se ha establecido la direcci\u00f3n f\u00edsica como 0x26.</p> <p> </p>"},{"location":"previos/#definicion-de-simbolos-en-la-lcd","title":"Definici\u00f3n de s\u00edmbolos en la LCD","text":"<p>Dentro de los bloques del men\u00fa Visualizaci\u00f3n -&gt; Pantalla LCD est\u00e1 el de \"definir s\u00edmbolo\", que permite definir uno de los 8 s\u00edmbolos personalizables que puede almacenar la pantalla LCD. El s\u00edmbolo se define por un mapa de bits (unos y ceros indicando cada p\u00edxel del s\u00edmbolo). Los s\u00edmbolos tienen una resoluci\u00f3n de 5x8 p\u00edxeles (blanco o negro).</p> <p>En STEAMakersBlocks disponemos de una herramienta que nos ayuda a definir nuestros propios s\u00edmbolos y podemos acceder a ella desde herramientas o haciendo clic derecho sobre el bloque, despleg\u00e1ndose en cualquier caso un editor muy sencillo de usar y que vemos con un ejemplo en la imagen en la siguiente:</p> <p> </p> <p>Para tener el s\u00edmbolo disponible simplemente copiamos la cadena generada en el lugar correspondiente del bloque.</p>"},{"location":"previos/#matriz-8x8-leds","title":"Matriz 8x8 LEDs","text":"<p>Una distribuci\u00f3n de 8x8 LEDs en forma de matriz permite crear una pantalla peque\u00f1a que tiene 64 LEDs con el aspecto de la Figura siguiente y que se conecta al puerto de comunicaci\u00f3n I2C.</p> <p> </p> <p>Este mismo componente visto por su cara posterior:</p> <p> </p> <p>Este tipo de matrices son 'multiplexadas', por lo que para controlar 64 LED necesitas 16 pines y eso son muchos pines aunque hay chips de controladores como el MAX7219 que pueden controlar una matriz, pero a\u00fan as\u00ed hay mucho cableado que configurar y ocupan muchos pines. Para solucionar esto se utiliza un chip de control que tiene un reloj incorporado para multiplexar la pantalla. Adem\u00e1s del m\u00f3dulo utiliza una fuente de corriente constante que permite obtener un color uniforme y brillante de todos los diodos. El conjunto forma una matriz de 8x8 que se controla a trav\u00e9s de una interfaz I2C.</p> <p>Sus principales caracter\u00edsticas son:</p> <ul> <li>Matriz de LEDs de 8 filas y 8 columnas</li> <li>Direccionada por un chip HT16K33</li> <li>Conexi\u00f3n tipo I2C</li> <li>Tensi\u00f3n de alimentaci\u00f3n: 5V</li> <li>Frecuencia de trabajo: 400KHz</li> <li>Potencia de entrada: 2.5W</li> <li>Corriente de entrada: 500mA</li> </ul> <p>Tambi\u00e9n existen matrices en las que est\u00e1 disponible un m\u00e9todo de cambio de la direcci\u00f3n f\u00edsica del dispositivo mediante micro interruptores, como la que vemos en la imagen siguiente:</p> <p> </p> <p>Estos dispositivos disponen de su propio men\u00fa de bloques y de un dise\u00f1ador de mapas de bits similar al visto para los s\u00edmbolos de la LCD que podemos apreciar en la figura siguiente:</p> <p> </p>"},{"location":"previos/#control-de-un-servomotor","title":"Control de un servomotor","text":""},{"location":"previos/#el-servomotor","title":"El servomotor","text":"<p>Un servomotor o abreviado servo es un motor especial que puede posicionar su eje en un \u00e1ngulo determinado y lo puede mantener en esta posici\u00f3n. Los servos est\u00e1ndar suelen girar 180\u00ba, pero es habitual encontrar servos que giran 90\u00ba y otros 360\u00ba, que son los conocidos como servos de rotaci\u00f3n continua. En el interior del mismo est\u00e1n ubicados tanto la electr\u00f3nica de control como los engranajes reductores que a su vez pueden llevar o no topes f\u00edsicos que marquen el \u00e1ngulo de giro. Para su funcionamiento s\u00f3lo necesitan ser alimentados (conexiones GND y VCC o 5V) y una se\u00f1al de control.</p> <p>Los servomotores son en realidad motores de corriente continua a los que se les ha a\u00f1adido una reductora, para que giren m\u00e1s despacio y con m\u00e1s fuerza, y un controlador electr\u00f3nico que permite hacer que gire un determinado \u00e1ngulo. Adem\u00e1s, el servo en todo momento sabe en qu\u00e9 posici\u00f3n est\u00e1, aunque se apague o reinicie. Esto significa que si a un servo que hemos movido a un determinado punto, lo hemos dejado sin alimentaci\u00f3n y al alimentarlo de nuevo le indicamos que gire 90\u00ba, no va a girar 90\u00ba sino que se va a dirigir a su posici\u00f3n de 90\u00ba que tiene memorizada internamente.</p> <p>En la figura siguiente vemos el interior de un servo esquematizado.</p> <p> </p> <p>Su aspecto real lo vemos en esta otra figura, donde tambi\u00e9n se aprecian los accesorios y torniller\u00eda que lo acompa\u00f1an.</p> <p> </p> <p>Veamos su principio b\u00e1sico de funcionamiento: La electr\u00f3nica de control del servomotor tiene un circuito de referencia incorporado que emite la se\u00f1al de referencia, que es un ciclo de 20 ms con un ancho de pulso de 1,5 ms. Se compara la tensi\u00f3n de control recibida con la de referencia y se genera una diferencia de tensi\u00f3n. El circuito de control en la placa decidir\u00e1 la direcci\u00f3n de rotaci\u00f3n en consecuencia y accionar\u00e1 el motor. El sistema de engranajes o reductora convierten el giro del motor en un par de fuerza a trav\u00e9s del eje. El sensor detecta que se ha alcanzado la posici\u00f3n enviada de acuerdo con la se\u00f1al de retroalimentaci\u00f3n. Cuando la diferencia de tensi\u00f3n existe el motor gira y cuando la diferencia se reduce a cero, el motor se detiene. Normalmente, el \u00e1ngulo de rotaci\u00f3n es de 0 a 180 grados.</p> <p>El servomotor viene con un conector hembra de tres pines para tres cables de conexi\u00f3n, que se distinguen por los colores marr\u00f3n, rojo y naranja (diferentes marcas pueden tener diferentes colores).</p> <p>El \u00e1ngulo de rotaci\u00f3n del servomotor se controla regulando el ciclo de trabajo de la se\u00f1al PWM cuyo est\u00e1ndar es de 20 ms (50 Hz).</p> <p>Hay que tener mucho cuidado de posicionar el conector de los servos en los tres pines macho de la shield en el orden correcto (el conector es reversible) o seguramente romperemos algo de manera irremediable.</p> <p>Existe un tipo especial de servomotor que permite la rotaci\u00f3n continua. En algunos casos se trata de servomotores \u201ctrucados\u201d de forma que se modifican para permitir la rotaci\u00f3n continua quitando los topes mec\u00e1nicos y se sustituye el potenci\u00f3metro por un divisor de tensi\u00f3n con dos resistencia iguales (en algunos casos no se ponen resistencias y se bloquea el potenci\u00f3metro para que no gire dej\u00e1ndolo justo en su punto central). Este tipo de modificaci\u00f3n la podemos realizar nosotros (en la web existen multitud de tutoriales) o tambi\u00e9n podemos comprar un servomotor de rotaci\u00f3n continua listo para funcionar sin tener que hacer ning\u00fan tipo de bricolaje.</p> <p>En el apartado de bloques de programaci\u00f3n, se encuentra en \"Motor / Servo\" y en la figura siguiente vemos los bloques disponibles.</p> <p> </p> <p>Para controlar el servomotor, indicamos los grados de rotaci\u00f3n (\u00c1ngulo de giro) que queremos y el tiempo de retardo, o tiempo que tarda en ir de una posici\u00f3n a otra.</p> <p>El control de un servomotor de rotaci\u00f3n continua se realiza de igual manera, pero su reacci\u00f3n es diferente.</p> <p>Los bloques Servo-Oscilador nos permiten de una forma sencilla hacer que el servo repita una secuencia de movimientos u oscilaciones de forma indefinida. Un ejemplo t\u00edpico puede ser el que vemos en la figura siguiente, donde el servo oscila entre 0 y 90\u00ba en periodos de dos segundos.</p> <p> </p> <p>El bloque Servo-I2C (PCA9685) es simplemente un bloque para manejar la tarjeta controladora para 16 servos PCA9685 utilizando el bus I2C.</p>"},{"location":"previos/#tipos-de-servomotores","title":"Tipos de servomotores","text":"<p>La clasificaci\u00f3n b\u00e1sica la podemos establecer en los siguientes 4 tipos:</p> <ul> <li>Servomotores de corriente continua, que son los m\u00e1s habituales. Funcionan mediante un motor de corriente continua controlado por PWM. Dentro de estos existen multitud de ellos diferenciados por su torque y por su m\u00e1ximo \u00e1ngulo de giro. Para nuestros proyectos los m\u00e1s usuales son los que vemos en la imagen siguiente:</li> </ul> <p> </p> <p>Vemos en la imagen los tres tipos comerciales de Keyestudio para servos tipo 9g.</p> <ul> <li>Servomotores de corriente alterna, que se utilizan para controlar grandes fuerzas.</li> <li>Servomotores de imanes permanentes o Brushless. Construidos a base de motores de corriente alterna sin escobillas. Se utilizan para grandes torques y altas velocidades. Su uso principal est\u00e1 en la industria.</li> </ul>"},{"location":"previos/#posicion-de-inicio-del-servo","title":"Posici\u00f3n de inicio del servo","text":"<p>Antes de fijar con su tornillo cualquiera de las palas debemos averiguar cual es la posici\u00f3n de 0\u00ba o inicial del servo. Para ello vamos a crear el programa \"KS_UNO_Posicionar_servo\" que vemos en la figura siguiente o que podemos importar del enlace.</p> <p> </p> <p>Ejecutamos el programa que hemos cargado en la placa, y lo tenemos que parar en el momento que el servo vuelve a la posici\u00f3n inicial (hace un giro repentino de 180\u00ba tras un tiempo de espera). En ese momento, quitamos el soporte tipo aspa vigilando de que no se modifique la posici\u00f3n del servo. Sin que el servomotor se haya movido, montamos el soporte en su lugar y damos por concluida la tarea.</p>"},{"location":"previos/#listas","title":"Listas","text":"<p>Las listas son un gran recurso del que podemos aprender mucho a trav\u00e9s de los dos videos siguientes obra del autor de STEAMakersBlocks:</p> <ul> <li>Listas num\u00e9ricas din\u00e1micas</li> <li>Listas de texto din\u00e1micas</li> </ul> <p>Las listas de datos nos permiten almacenar un listado de valores y acceder a ellos por su posici\u00f3n o \u00edndice en la lista. Las listas pueden ser de tipo num\u00e9ricas o de texto, como vemos en la imagen siguiente:</p> <p> </p> <p>Ahora la inicializaci\u00f3n de las listas es din\u00e1mica y cuando creamos, por ejemplo, una de tipo num\u00e9rico podemos ver todos los bloques disponibles para esa lista:</p> <p> </p> <p>Si retomamos el ejemplo de posicionamiento del servo, podemos definir las posiciones repitiendo tantas veces como necesitemos el primero de los bloques o dando la lista de valores con el segundo en formato CSV, e incluso mezclar ambos bloques para definir dichas posiciones.</p> <p>Vamos a implementar dicho programa mediante listas.</p> <ul> <li>Caso 1: repitiendo posiciones. El programa para este caso ser\u00eda el siguiente:</li> </ul> <p> </p> <ul> <li>Caso 2: Definiendo una lista de valores. El programa para este caso ser\u00eda el siguiente:</li> </ul> <p> </p>"},{"location":"previos/#el-sensor-de-ultrasonidos-hc-sr04","title":"El sensor de ultrasonidos HC-SR04","text":"<p>Los sensores ultras\u00f3nicos utilizan un sonar para determinar la distancia desde el sensor al objeto. Este m\u00f3dulo utiliza un chip CS100A que puede medir distancias entre 4 cm y 300 cm siendo la medida precisa y estable. El m\u00f3dulo incluye el transmisor y el receptor ultras\u00f3nicos y su circuito de control. El dispositivo debe conectarse a dos pines, lo que se debe a que para su funcionamiento necesita uno para emitir el ultrasonido (Trigger) y otro para recibirlo (Echo). El principio de funcionamiento es el de la figura siguiente:</p> <p> </p> <p>El sensor lo que hace es medir el tiempo (t) en microsegundos que tarda en recibir el eco del sonido emitido y como la velocidad (v) es conocida, se trata de la velocidad del sonido, que es de 340 m/s o 0.034 cm/\u03bcs, la distancia vendr\u00e1 dada por la siguiente ecuaci\u00f3n:</p> <p>\\(d = v \\cdot t = 0.034(\\dfrac{cm}{\\mu s}) \\cdot t (\\mu s) = 0.034 \\cdot t (cm)\\)</p> <p>\\(d = v \\cdot t = 0.034(\\dfrac{cm}{\\mu s}) \\cdot t (\\mu s) = 0.034 \\cdot t (cm)\\)</p> <p>Aunque nosotros no debemos preocuparnos por esto puesto que el bloque ya no devuelve esta distancia medida en cm. Su aspecto lo vemos en la figura siguiente:</p> <p> </p> <p>El m\u00f3dulo detector ultras\u00f3nico proporciona una distancia de detecci\u00f3n sin contacto que va de 2 cm a 450 cm, con una precisi\u00f3n de 3 mm y un \u00e1ngulo de 15\u00ba. El m\u00f3dulo incluye un transmisor y un receptor de ultrasonidos, as\u00ed como el circuito de control correspondiente y basa su funcionamiento en la secuencia de trabajo que vemos en la figura siguiente.</p> <p> </p> <ol> <li>Partiendo de un nivel bajo de trigger lo mantenemos activado o en estado alto al menos durante 10 us.</li> <li>Tras el disparo el m\u00f3dulo emitir\u00e1 una r\u00e1faga de pulsos cuadrados de 40 KHz y detectar\u00e1 autom\u00e1ticamente si hay una se\u00f1al de regreso.</li> <li>Si hay una se\u00f1al de retorno, se emite un nivel alto a trav\u00e9s de ECHO. El tiempo de duraci\u00f3n de este nivel alto es en realidad el tiempo transcurrido desde la emisi\u00f3n hasta la recepci\u00f3n del ultrasonido.</li> </ol> <p>En el apartado de bloques de programaci\u00f3n, se encuentra en \"Sensores\" y tiene el aspecto de la figura siguiente:</p> <p> </p>"},{"location":"previos/#emisor-y-receptor-de-infrarrojos","title":"Emisor y receptor de infrarrojos","text":""},{"location":"previos/#que-son-los-infrarrojos","title":"\u00bfque son los infrarrojos?","text":"<p>Son una clase de radiaci\u00f3n electromagn\u00e9tica con una longitud de onda que resulta superior a la longitud de onda de la luz visible, siendo su frecuencia superior a las microondas. Dentro del espectro electromagn\u00e9tico, la radiaci\u00f3n infrarroja se encuentra comprendida entre el espectro de luz visible y las microondas. Tiene longitudes de onda mayores o m\u00e1s largas que el rojo. En la imagen siguiente, obtenida del blog de Mercedes Gonz\u00e1lez Mas vemos caracterizados los infrarrojos dentro del espectro.</p> <p> </p> <p>Como podemos observar en la imagen, los rayos infrarrojos son clasificados, de acuerdo a su longitud de onda, del siguiente modo:</p> <ul> <li>infrarrojo cercano, con longitud de onda entre 0.7 \u00b5m y 1.1 \u00b5m, es la parte del espectro infrarrojo que ese encuentra m\u00e1s pr\u00f3ximo a la luz visible.</li> <li>infrarrojo medio, con longitud de onda entre 1,1 \u00b5m y 15 \u00b5m.</li> <li>infrarrojo lejano o regi\u00f3n m\u00e1s cercana a las microondas, con longitud de onda entre 15 \u00b5m y 100 \u00b5m</li> </ul> <p>En la imagen siguiente, obtenida de Wikipedia, sobre espectro electromagn\u00e9tico podemos ver m\u00e1s informaci\u00f3n del tema.</p> <p> </p> <p>Todos los cuerpos emiten una cierta cantidad de radiaci\u00f3n, y aunque esta resulta invisible para el ojo humano, existen dispositivos electr\u00f3nicos capaces de \"verla\" por estar dise\u00f1ados para ello.</p>"},{"location":"previos/#diodo-receptor-de-infrarrojos","title":"Diodo receptor de infrarrojos","text":"<p>Uno de los receptores m\u00e1s universal utilizado en placas tipo Arduino es el receptor de infrarrojos universal TL1838, VS1838B o simplemente 1835 de 38KHz, cuyo aspecto podemos ver en la imagen siguiente:</p> <p> </p> <p>En el datasheet TL1838 del dispositivo tenemos toda la informaci\u00f3n sobre el mismo destacando las siguientes caracter\u00edsticas:</p> <ul> <li>Voltaje de funcionamiento: 2.7V a 5.5V</li> <li>Frecuencia: 37.9KHz</li> <li>\u00c1ngulo de recepci\u00f3n: 90\u00b0</li> <li>Rango de recepci\u00f3n: 18m</li> </ul> <p>El dispositivo genera una se\u00f1al de salida que sirve para controles remotos universales y utiliza la codificaci\u00f3n NEC. El receptor de infrarrojos permite codificar los protocolos de se\u00f1ales de pulsos infrarrojos utilizados por los mandos a distancia. Los protocolos detectados son los siguientes: RC5, RC6, NEC, SONY, PANASONIC, JVC, SAMSUNG, WHYNTER, AIWA, LG, SANYO, MITSUBISHI y DENON. Es decir, detectar\u00eda cualquier se\u00f1al emitida por cualquiera de esos mandos.</p>"},{"location":"previos/#emisor-de-infrarrojos","title":"Emisor de infrarrojos","text":"<p>En nuestro caso como emisor de infrarrojos vamos a utilizar el control remoto de Keyestudio que vemos en la imagen siguiente:</p> <p> </p> <p>El mini control remoto tiene 17 teclas de funci\u00f3n y tiene las siguientes especificaciones:</p> <ul> <li>Bater\u00eda: pilas de bot\u00f3n CR2025</li> <li>Distancia de transmisi\u00f3n: hasta 8 m</li> <li>\u00c1ngulo efectivo: 60\u00b0</li> </ul> <p>El control remoto, o mando a distancia, por IR funciona emitiendo trenes de pulsos de luz infrarroja. Diferentes se\u00f1ales corresponden a botones diferentes La se\u00f1al infrarroja transmite el c\u00f3digo correspondiente al bot\u00f3n del mando a distancia pulsado al dispositivo en forma de una serie de impulsos de luz infrarroja. El receptor recibe la serie de impulsos de infrarrojos y los pasa a un procesador que decodifica y activar\u00e1n una determinada funci\u00f3n del dispositivo. En el reto y las actividades del mismo obtendremos estos c\u00f3digos. En STEAMakersBlocks se han asignado los siguientes nombres a las teclas:</p> <p> </p>"},{"location":"previos/#bloques-en-steamakersblocks","title":"Bloques en STEAMakersBlocks","text":"<p>El sensor receptor de infrarrojos permite obtener la cadena de texto con el c\u00f3digo en formato hexadecimal correspondiente al tren de pulsos de IR generado al pulsar una determinada tecla. El bloque puede ser uno de los que vemos en la imagen siguiente, dependiendo del tipo de proyecto en el que estemos:</p> <p> </p> <p>El valor devuelto por el bloque de recepci\u00f3n ser\u00e1 una cadena de texto con valor vac\u00edo en caso de no detectar ning\u00fan c\u00f3digo. Al devolver el bloque una cadena de texto debemos recordar que lo tenemos que almacenar en una variable de tipo texto.</p> <p>Si utilizamos mandos gen\u00e9ricos RC5 como el modelo de Keyestudio, podemos usar el bloque de la imagen siguiente para comparar los c\u00f3digos recibidos y as\u00ed identificar f\u00e1cilmente cada tecla.</p> <p> </p>"},{"location":"problemasUSB/","title":"Problemas de conexi\u00f3n USB","text":"<p>La descripci\u00f3n que sigue se produce en las siguientes condiciones:</p> <ul> <li>Sistema operativo: Ubuntu 22.04.5 LTS (Jammy Jellyfish)</li> <li>Navegador: Chromium, Versi\u00f3n 140.0.7259.2 (Build oficial) snap (64 bits)</li> <li>Programa: MicroBlocks, Versi\u00f3n v2.0.60 pilot</li> <li>Dispositivo microcontrolado: Placa Foxbit</li> </ul> <p>Si tu caso es similar o tienes el mismo tipo de problema puedes probar los comandos descritos para ver si se soluciona.</p> <p>La problem\u00e1tica parte de la siguiente situaci\u00f3n: cuando se conecta la placa a un puerto USB se intenta actualizar el firmware de la misma se inicia el proceso tal y como vemos en la imagen siguiente:</p> <p> </p> <p>Pero no se produce ning\u00fan progreso y tras un tiempo la ventana pasa a tener el aspecto habitual. Si se hace clic en \"Conecta\" y se elige \"Conect (USB)\" se abre la ventana de dispositivos vinculados:</p> <p> </p> <p>Al hacer clic en el bot\u00f3n \"Conectar\" aparentemente no ocurre nada y no se muestra la placa conectada ni el logo en verde. En cambio si vamos a desplegar \"Conecta\" vemos lo siguiente:</p> <p> </p> <p>Aparentemente la placa est\u00e1 conectada pero la conexi\u00f3n no es completa y si se intenta ejecutar algo en la misma genera error de \"Placa no conectada\", tal y como vemos en la animaci\u00f3n siguiente:</p> <p> </p> <p>El problema radica en la configuraci\u00f3n de las conexiones en caliente o hotplug y su integraci\u00f3n en USB u Udev bajo Linux. La entrada udev encontrada en Wikipedia que se reproduce a continuaci\u00f3n lo acalara a la perfecci\u00f3n:</p> <p> </p> <p>udev es el gestor de dispositivos que usa el n\u00facleo Linux en su versi\u00f3n 2.6. Su funci\u00f3n es controlar los ficheros de dispositivo en /dev. Es el sucesor de devfs y de hotplug, lo que significa que maneja el directorio /dev y todas las acciones del espacio de usuario al agregar o quitar dispositivos, incluyendo la carga de firmwares.</p> <p>El problema lo centramos en el navegador y que este ha sido instalado desde la tienda Snap.</p>"},{"location":"problemasUSB/#hotplug","title":"Hotplug","text":"<p>Seg\u00fan la documentaci\u00f3n de soporte sobre Hotplug dada por Canonical la compatibilidad con Hotplug est\u00e1 actualmente en desarrollo y estar\u00e1 disponible en una versi\u00f3n futura de snapd.</p> <p>Hay que habilitar la conexi\u00f3n en caliente dado que Hotplug es actualmente una funci\u00f3n experimental.</p> <p>El soporte de hotplug se habilita con el siguiente comando:</p> <pre><code>sudo snap set system experimental.hotplug=true\n</code></pre> <p>Para que el comando tenga efecto es necesario reiniciar snapd o volver a conectar los dispositivos USB para iniciar el procesamiento de conexi\u00f3n en caliente para los dispositivos conectados.</p> <pre><code>sudo systemctl restart snapd\n</code></pre>"},{"location":"problemasUSB/#chromium","title":"Chromium","text":"<p>En primer lugar a\u00f1adimos a Chromium raw-usb para permitir el acceso a todos los dispositivos USB conectados.</p> <pre><code>sudo snap connect chromium:raw-usb\n</code></pre> <p>A\u00f1adimos puerto serie a la conexi\u00f3n:</p> <pre><code>sudo snap connect chromium:serial-port\n</code></pre>"},{"location":"Miscelanea/about/","title":"Autor","text":"<p> Federico Coca</p> <ul> <li> <p>GitHub</p> </li> <li> <p>Bluesky</p> </li> <li> <p>Instagram</p> </li> <li> <p>Mas informaci\u00f3n</p> </li> </ul>"},{"location":"Miscelanea/lic/","title":"Licencias","text":"<ul> <li> <p>Licencia MIT incluida en la creaci\u00f3n del repositorio.</p> </li> <li> <p>Creative Commons Atribuci\u00f3n-CompartirIgual 4.0 International (\"CC BY-SA\"). CC BY-SA 4.0 </p> </li> </ul> <p> </p>"},{"location":"Miscelanea/soft/","title":"Software utilizado","text":"<ul> <li> <p>Sistema operativo: Ubuntu 22.04.4 LTS</p> </li> <li> <p>Dibujo 3D FreeCAD</p> </li> <li> <p>Esquemas de montaje creados con Fritzing</p> </li> <li> <p>Paquete ofim\u00e1tico de referencia: LibreOffice</p> </li> <li> <p>Libreria Material para MkDocs</p> </li> <li> <p>Visual Studio Code</p> </li> <li> <p>Creaci\u00f3n de GIF animados para Ubuntu Peek</p> </li> <li> <p>Sistema principal de capturas de pantalla: Shutter</p> </li> <li> <p>Dibujo 2D vectorial Inkscape</p> </li> <li> <p>Retoque de im\u00e1genes GIMP</p> </li> <li> <p>Capturadora de video e im\u00e1gen para webcam XAWVT. Se instala con <code>sudo apt install xawtv</code></p> </li> <li> <p>Grabaci\u00f3n de escritorio con vokoscreen</p> </li> <li> <p>Programaci\u00f3n por bloques con ArduinoBlocks</p> </li> <li> <p>Programaci\u00f3n por bloques con MicroBlocks</p> </li> <li> <p>Programaci\u00f3n mediante el IDE de Arduino</p> </li> </ul>"}]}